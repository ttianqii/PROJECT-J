# PROJECT-J æŠ€è¡“å ±å‘Šæ›¸

## AIé§†å‹•ã‚¿ã‚¤ãƒ»æ—¥æœ¬èªç™ºéŸ³å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆã¨å®Ÿè£…

---

**å ±å‘Šæ›¸ç•ªå·:** PJ-TECH-001  
**ä½œæˆæ—¥:** 2026å¹´2æœˆ25æ—¥  
**åˆ†é¡:** æŠ€è¡“æ–‡æ›¸ - ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç·¨  
**å¯¾è±¡èª­è€…:** ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€æŠ€è¡“ãƒªãƒ¼ãƒ€ãƒ¼ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼

---

## è¦ç´„ï¼ˆExecutive Summaryï¼‰

æœ¬å ±å‘Šæ›¸ã¯ã€PROJECT-Jã®æŠ€è¡“çš„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€å®Ÿè£…è©³ç´°ã€ãŠã‚ˆã³ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆã«ã¤ã„ã¦è©³è¿°ã™ã‚‹ã€‚æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚¿ã‚¤äººã¨æ—¥æœ¬äººã®ç›¸äº’ç™ºéŸ³å­¦ç¿’ã‚’æ”¯æ´ã™ã‚‹AIé§†å‹•å‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ã‚Šã€OpenAI Whisperã«ã‚ˆã‚‹éŸ³å£°èªè­˜ã€GPT-4oã«ã‚ˆã‚‹ç™ºéŸ³åˆ†æã€ãŠã‚ˆã³ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ©Ÿæ§‹ã‚’çµ±åˆã—ã¦ã„ã‚‹ã€‚

**ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:** ç™ºéŸ³å­¦ç¿’ã€AIã€Whisperã€GPT-4oã€TypeScriptã€Reactã€Elysia

---

## ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#1-ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°](#2-æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°)
3. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#3-ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
4. [æ©Ÿèƒ½ä¸€è¦§ã¨å®Ÿè£…è©³ç´°](#4-æ©Ÿèƒ½ä¸€è¦§ã¨å®Ÿè£…è©³ç´°)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#5-ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
6. [ã‚³ã‚¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ](#6-ã‚³ã‚¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ )
7. [APIä»•æ§˜è©³ç´°](#7-apiä»•æ§˜è©³ç´°)
8. [å®Ÿè£…ä¸Šã®æ³¨æ„äº‹é …](#8-å®Ÿè£…ä¸Šã®æ³¨æ„äº‹é …)

---

## 1. ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### 1.1 ã‚·ã‚¹ãƒ†ãƒ ç›®çš„

PROJECT-Jã¯ä»¥ä¸‹ã®å­¦ç¿’ã‚·ãƒŠãƒªã‚ªã‚’æ”¯æ´ã™ã‚‹ï¼š

| å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ | å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ | å­¦ç¿’å†…å®¹ |
|-----------|-------------|----------|
| `th-ja` | ã‚¿ã‚¤äºº | æ—¥æœ¬èªç™ºéŸ³ã®ç¿’å¾— |
| `ja-th` | æ—¥æœ¬äºº | ã‚¿ã‚¤èªç™ºéŸ³ã®ç¿’å¾— |

### 1.2 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå±¤                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   éŒ²éŸ³æ©Ÿèƒ½    â”‚  â”‚   UIè¡¨ç¤º     â”‚  â”‚   TTSå†ç”Ÿ    â”‚              â”‚
â”‚  â”‚  MediaRecorderâ”‚  â”‚  React/Vite  â”‚  â”‚  Web Speech  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTPS/WebSocket
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         APIã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤å±¤                           â”‚
â”‚                         Elysia.js (Bun)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢: CORS, Swagger, ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ ç™ºéŸ³è©•ä¾¡      â”‚  â”‚ æ–‡å­—èµ·ã“ã—    â”‚  â”‚ å˜èªæ¤œç´¢     â”‚              â”‚
â”‚  â”‚  /assess     â”‚  â”‚ /transcribe  â”‚  â”‚  /lookup     â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AIã‚µãƒ¼ãƒ“ã‚¹å±¤                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    OpenAI API                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚  â”‚  â”‚  Whisper-1  â”‚  â”‚   GPT-4o    â”‚  â”‚  Chat API   â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  éŸ³å£°èªè­˜   â”‚  â”‚ ç™ºéŸ³åˆ†æ    â”‚  â”‚ å˜èªæ¤œç´¢    â”‚         â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°

### 2.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

#### 2.1.1 ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ãƒ©ãƒ³ã‚¿ã‚¤ãƒ 

| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” | é¸å®šç†ç”± |
|------|-----------|------|----------|
| **React** | 19.2.0 | UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Concurrent Featuresã€æœ€æ–°ã®çŠ¶æ…‹ç®¡ç† |
| **TypeScript** | 5.9.3 | å‹ã‚·ã‚¹ãƒ†ãƒ  | å³æ ¼ãªå‹å®‰å…¨æ€§ã€ä¿å®ˆæ€§å‘ä¸Š |
| **Vite** | 7.3.1 | ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ« | é«˜é€ŸHMRã€æœ€é©åŒ–ã•ã‚ŒãŸãƒãƒ³ãƒ‰ãƒ« |

#### 2.1.2 ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã¨UI

```typescript
// tailwind.config.ts ç›¸å½“ã®è¨­å®š
// TailwindCSS v4 ã¯ CSS-first æ§‹æˆã‚’æ¡ç”¨

import tailwindcss from '@tailwindcss/vite'

// vite.config.ts
export default defineConfig({
  plugins: [
    react(),
    tailwindcss(),  // v4: PostCSSä¸è¦ã€Viteãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦çµ±åˆ
  ],
})
```

| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| **TailwindCSS** | 4.2.1 | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£CSS |
| **Radix UI** | 1.4.3 | ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| **Lucide React** | 0.575.0 | ã‚¢ã‚¤ã‚³ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |
| **Motion** | 12.34.3 | ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |

#### 2.1.3 çŠ¶æ…‹ç®¡ç†ã¨ãƒ‡ãƒ¼ã‚¿å–å¾—

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€è»½é‡ãªçŠ¶æ…‹ç®¡ç†ã¨ã—ã¦Reactã®çµ„ã¿è¾¼ã¿æ©Ÿèƒ½ã‚’ä½¿ç”¨ï¼š

```typescript
// ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ç®¡ç†: React Contextæœªä½¿ç”¨
// ç†ç”±: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¦æ¨¡ãŒå°ã€œä¸­è¦æ¨¡ã®ãŸã‚ã€prop drillingã§ååˆ†

// çŠ¶æ…‹ç®¡ç†ã®éšå±¤
- App.tsx: ãƒ¢ãƒ¼ãƒ‰çŠ¶æ…‹ã€é¸æŠå˜èªã€è©•ä¾¡çµæœ
- å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: ãƒ­ãƒ¼ã‚«ãƒ«UIçŠ¶æ…‹
- APIå±¤: ã‚µãƒ¼ãƒãƒ¼ã‚¹ãƒ†ãƒ¼ãƒˆï¼ˆTanStack Queryæœªä½¿ç”¨ã€ã‚·ãƒ³ãƒ—ãƒ«ãªfetchï¼‰
```

### 2.2 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

#### 2.2.1 ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” | é¸å®šç†ç”± |
|------|-----------|------|----------|
| **Bun** | 1.0+ | JavaScriptãƒ©ãƒ³ã‚¿ã‚¤ãƒ  | é«˜é€Ÿèµ·å‹•ã€çµ„ã¿è¾¼ã¿TypeScriptã‚µãƒãƒ¼ãƒˆ |
| **Elysia** | 1.4.25 | Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | å‹å®‰å…¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€é«˜æ€§èƒ½ |
| **TypeScript** | 5.0+ | å‹ã‚·ã‚¹ãƒ†ãƒ  | ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®å‹å®‰å…¨æ€§ |

#### 2.2.2 å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ

```typescript
// OpenAIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
import OpenAI from 'openai'

function getOpenAI(): OpenAI {
  const key = process.env.OPENAI_API_KEY
  if (!key) throw new Error('OPENAI_API_KEY is not set')
  return new OpenAI({ apiKey: key })
}
```

| ã‚µãƒ¼ãƒ“ã‚¹ | ãƒ¢ãƒ‡ãƒ« | ç”¨é€” | ã‚³ã‚¹ãƒˆç›®å®‰ |
|----------|--------|------|-----------|
| **Whisper** | whisper-1 | éŸ³å£°èªè­˜ | $0.006/åˆ† |
| **GPT-4o** | gpt-4o | ç™ºéŸ³åˆ†æã€å˜èªæ¤œç´¢ | $0.005/1K tokens |

### 2.3 é–‹ç™ºãƒ„ãƒ¼ãƒ«ã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```json
// package.json - ãƒ«ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ§‹æˆ
{
  "workspaces": ["frontend", "backend"],
  "scripts": {
    "dev": "concurrently --names 'frontend,backend' \"bun run dev:frontend\" \"bun run dev:backend\"",
    "dev:frontend": "cd frontend && bun run dev",
    "dev:backend": "cd backend && bun run dev"
  }
}
```

---

## 3. ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 3.1 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ è©³ç´°

```
PROJECT-J/
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/           # ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ smoothui/        # å†åˆ©ç”¨å¯èƒ½UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ siri-orb/    # éŸ³å£°å¯è¦–åŒ–
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ai-input/    # AIå…¥åŠ›ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”‚   â”œâ”€â”€ LanguageSelectScreen.tsx   # è¨€èªé¸æŠç”»é¢
â”‚   â”‚   â”‚   â”œâ”€â”€ PresetScreen.tsx           # ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠ
â”‚   â”‚   â”‚   â”œâ”€â”€ WordCard.tsx               # å˜èªã‚«ãƒ¼ãƒ‰
â”‚   â”‚   â”‚   â”œâ”€â”€ PronunciationRecorder.tsx  # ç™ºéŸ³éŒ²éŸ³
â”‚   â”‚   â”‚   â”œâ”€â”€ AccuracyFeedback.tsx       # ç²¾åº¦ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
â”‚   â”‚   â”‚   â”œâ”€â”€ FreeSpeak.tsx              # ãƒ•ãƒªãƒ¼ã‚¹ãƒ”ãƒ¼ã‚¯
â”‚   â”‚   â”‚   â”œâ”€â”€ SentenceBreakdown.tsx      # æ–‡åˆ†è§£
â”‚   â”‚   â”‚   â””â”€â”€ BottomNav.tsx              # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ hooks/               # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ useAudioRecorder.ts   # éŒ²éŸ³çŠ¶æ…‹ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ useTTS.ts             # èª­ã¿ä¸Šã’åˆ¶å¾¡
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/            # APIé€šä¿¡å±¤
â”‚   â”‚   â”‚   â””â”€â”€ api.ts           # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ utils/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ i18n.ts          # å›½éš›åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ phonetics.ts     # éŸ³éŸ¿å‡¦ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ data/                # ãƒ‡ãƒ¼ã‚¿å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ ja-th.json       # æ—¥æœ¬èªâ†’ã‚¿ã‚¤èªèªå½™DB
â”‚   â”‚   â”‚   â””â”€â”€ th-ja.json       # ã‚¿ã‚¤èªâ†’æ—¥æœ¬èªèªå½™DB
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ types/               # å‹å®šç¾©å±¤
â”‚   â”‚   â”‚   â””â”€â”€ index.ts         # å…¨å‹å®šç¾©
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ App.tsx              # ãƒ«ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ main.tsx             # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚
â”‚   â””â”€â”€ vite.config.ts           # ãƒ“ãƒ«ãƒ‰è¨­å®š
â”‚
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ routes/
â”‚       â”‚   â””â”€â”€ pronunciation.ts # APIãƒ«ãƒ¼ãƒˆå®šç¾©
â”‚       â””â”€â”€ index.ts             # ã‚µãƒ¼ãƒãƒ¼åˆæœŸåŒ–
â”‚
â””â”€â”€ package.json                 # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹è¨­å®š
```

### 3.2 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä¾å­˜é–¢ä¿‚å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        frontend/src                             â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚   â”‚   main.tsx  â”‚                                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚          â”‚                                                      â”‚
â”‚          â–¼                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚   App.tsx   â”‚â—„â”€â”€â”€â”€â”‚   hooks/    â”‚     â”‚   data/     â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚             â”‚     â”‚             â”‚      â”‚
â”‚          â”‚            â”‚ useAudio    â”‚     â”‚ ja-th.json  â”‚      â”‚
â”‚          â–¼            â”‚ Recorder    â”‚     â”‚ th-ja.json  â”‚      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ useTTS      â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚   â”‚ components/ â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚   â”‚             â”‚            â”‚                                  â”‚
â”‚   â”‚ WordCard    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚   â”‚ Pronunciationâ”‚                                               â”‚
â”‚   â”‚ Recorder    â”‚â—„â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚ FreeSpeak   â”‚     â”‚                                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚                                         â”‚
â”‚          â”‚            â”‚                                         â”‚
â”‚          â–¼            â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚   â”‚      services/api.ts        â”‚                              â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                              â”‚
â”‚   â”‚  â”‚ assessPronunciation() â”‚  â”‚                              â”‚
â”‚   â”‚  â”‚ transcribeAudio()     â”‚  â”‚                              â”‚
â”‚   â”‚  â”‚ lookupWord()          â”‚  â”‚                              â”‚
â”‚   â”‚  â”‚ tokenizeSentence()    â”‚  â”‚                              â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                  â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ HTTP/REST
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        backend/src                              â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    index.ts                           â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚   â”‚  â”‚  CORS   â”‚  â”‚ Swagger â”‚  â”‚ pronunciationRoutes â”‚   â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                            â”‚                    â”‚
â”‚                                            â–¼                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚              routes/pronunciation.ts                  â”‚    â”‚
â”‚   â”‚                                                       â”‚    â”‚
â”‚   â”‚  POST /api/assess      â”€â”€â–º ç™ºéŸ³è©•ä¾¡                    â”‚    â”‚
â”‚   â”‚  POST /api/transcribe  â”€â”€â–º æ–‡å­—èµ·ã“ã—                  â”‚    â”‚
â”‚   â”‚  POST /api/lookup      â”€â”€â–º å˜èªæ¤œç´¢                    â”‚    â”‚
â”‚   â”‚  POST /api/tokenize    â”€â”€â–º æ–‡åˆ†è§£                     â”‚    â”‚
â”‚   â”‚  GET  /api/health      â”€â”€â–º ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯              â”‚    â”‚
â”‚   â”‚                                                       â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    OpenAI API                         â”‚    â”‚
â”‚   â”‚         Whisper-1  â”‚  GPT-4o  â”‚  Chat API             â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. æ©Ÿèƒ½ä¸€è¦§ã¨å®Ÿè£…è©³ç´°

### 4.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ©Ÿèƒ½ä¸€è¦§

#### 4.1.1 ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯

**â‘  useAudioRecorder - éŒ²éŸ³çŠ¶æ…‹ç®¡ç†**

```typescript
// frontend/src/hooks/useAudioRecorder.ts

import { useState, useRef, useCallback } from 'react'

export type RecordingState = 'idle' | 'recording' | 'processing'

interface UseAudioRecorderReturn {
  state: RecordingState
  start: () => Promise<void>
  stop: () => Promise<Blob | null>
  audioBlob: Blob | null
  error: string | null
  durationMs: number
}

/**
 * ãƒ–ãƒ©ã‚¦ã‚¶MediaRecorder APIã®ãƒ©ãƒƒãƒ‘ãƒ¼
 * éŒ²éŸ³çŠ¶æ…‹ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’ç®¡ç†ã™ã‚‹
 */
export function useAudioRecorder(): UseAudioRecorderReturn {
  const [state, setState] = useState<RecordingState>('idle')
  const [audioBlob, setAudioBlob] = useState<Blob | null>(null)
  const [error, setError] = useState<string | null>(null)
  const [durationMs, setDurationMs] = useState(0)

  // useRef: ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–“ã§å€¤ã‚’ä¿æŒ
  const mediaRecorderRef = useRef<MediaRecorder | null>(null)
  const chunksRef = useRef<Blob[]>([])
  const startTimeRef = useRef<number>(0)
  const resolveRef = useRef<((blob: Blob | null) => void) | null>(null)

  /**
   * éŒ²éŸ³ã‚’é–‹å§‹
   * 1. ãƒã‚¤ã‚¯è¨±å¯ã‚’è¦æ±‚
   * 2. MediaRecorderã‚’åˆæœŸåŒ–
   * 3. ãƒ‡ãƒ¼ã‚¿åé›†ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š
   */
  const start = useCallback(async () => {
    setError(null)
    setAudioBlob(null)
    chunksRef.current = []

    try {
      // ãƒã‚¤ã‚¯ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å–å¾—
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true })

      // ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹MIMEã‚¿ã‚¤ãƒ—ã‚’é¸æŠ
      // å„ªå…ˆé †ä½: opus > ogg > webm
      const mimeType = MediaRecorder.isTypeSupported('audio/webm;codecs=opus')
        ? 'audio/webm;codecs=opus'
        : MediaRecorder.isTypeSupported('audio/ogg;codecs=opus')
          ? 'audio/ogg;codecs=opus'
          : 'audio/webm'

      const recorder = new MediaRecorder(stream, { mimeType })
      mediaRecorderRef.current = recorder

      // ãƒ‡ãƒ¼ã‚¿åé›†ã‚¤ãƒ™ãƒ³ãƒˆ
      recorder.ondataavailable = (e) => {
        if (e.data.size > 0) chunksRef.current.push(e.data)
      }

      // éŒ²éŸ³åœæ­¢æ™‚ã®å‡¦ç†
      recorder.onstop = () => {
        const blob = new Blob(chunksRef.current, { type: mimeType })
        setAudioBlob(blob)
        setDurationMs(Date.now() - startTimeRef.current)
        setState('idle')
        // ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’è§£æ”¾
        stream.getTracks().forEach((t) => t.stop())
        resolveRef.current?.(blob)
        resolveRef.current = null
      }

      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
      recorder.onerror = (e) => {
        const msg = (e as unknown as { error?: { message?: string } }).error?.message ?? 'Recording error'
        setError(msg)
        setState('idle')
        resolveRef.current?.(null)
        resolveRef.current = null
      }

      // 100msé–“éš”ã§ãƒ‡ãƒ¼ã‚¿åé›†
      recorder.start(100)
      startTimeRef.current = Date.now()
      setState('recording')
    } catch (err) {
      const msg = err instanceof Error ? err.message : 'Microphone access denied'
      setError(msg)
      setState('idle')
    }
  }, [])

  /**
   * éŒ²éŸ³ã‚’åœæ­¢ã—ã€Blobã‚’è¿”ã™
   * Promiseãƒ™ãƒ¼ã‚¹ã§éåŒæœŸå‡¦ç†
   */
  const stop = useCallback((): Promise<Blob | null> => {
    return new Promise((resolve) => {
      if (!mediaRecorderRef.current || state !== 'recording') {
        resolve(null)
        return
      }
      resolveRef.current = resolve
      setState('processing')
      mediaRecorderRef.current.stop()
    })
  }, [state])

  return { state, start, stop, audioBlob, error, durationMs }
}
```

**â‘¡ useTTS - ãƒ†ã‚­ã‚¹ãƒˆèª­ã¿ä¸Šã›åˆ¶å¾¡**

```typescript
// frontend/src/hooks/useTTS.ts

import { useState, useCallback, useEffect } from 'react'

interface UseTTSReturn {
  speak: (text: string, lang: 'ja-JP' | 'th-TH') => void
  speaking: boolean
  supported: boolean
}

/**
 * Web Speech APIã®ãƒ©ãƒƒãƒ‘ãƒ¼
 * ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚¤ãƒ†ã‚£ãƒ–ã®éŸ³å£°åˆæˆã‚’ä½¿ç”¨
 */
export function useTTS(): UseTTSReturn {
  const [speaking, setSpeaking] = useState(false)
  const [supported, setSupported] = useState(false)

  useEffect(() => {
    // ãƒ–ãƒ©ã‚¦ã‚¶ã‚µãƒãƒ¼ãƒˆç¢ºèª
    setSupported('speechSynthesis' in window)
  }, [])

  const speak = useCallback((text: string, lang: 'ja-JP' | 'th-TH') => {
    if (!window.speechSynthesis) return

    // æ—¢å­˜ã®èª­ã¿ä¸Šã’ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
    window.speechSynthesis.cancel()

    const utterance = new SpeechSynthesisUtterance(text)
    utterance.lang = lang
    utterance.rate = 0.9  // ã‚„ã‚„é…ã‚
    utterance.pitch = 1.0

    utterance.onstart = () => setSpeaking(true)
    utterance.onend = () => setSpeaking(false)
    utterance.onerror = () => setSpeaking(false)

    window.speechSynthesis.speak(utterance)
  }, [])

  return { speak, speaking, supported }
}
```

#### 4.1.2 ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

**â‘  PronunciationRecorder - ç™ºéŸ³éŒ²éŸ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**

```typescript
// frontend/src/components/PronunciationRecorder.tsx

import { Mic, MicOff, Loader2 } from 'lucide-react'
import { useAudioRecorder } from '../hooks/useAudioRecorder'
import { assessPronunciation } from '../services/api'
import type { AssessResponse, LearnerMode, VocabEntry } from '../types'

interface Props {
  entry: VocabEntry
  mode: LearnerMode
  onResult: (result: AssessResponse) => void
  onError: (msg: string) => void
}

/**
 * ç™ºéŸ³éŒ²éŸ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
 * éŒ²éŸ³ãƒœã‚¿ãƒ³ â†’ APIé€ä¿¡ â†’ çµæœã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ ã®ãƒ•ãƒ­ãƒ¼
 */
export function PronunciationRecorder({ entry, mode, onResult, onError }: Props) {
  const { state, start, stop } = useAudioRecorder()
  const isJapanese = mode === 'th-ja'
  const lang: 'ja' | 'th' = isJapanese ? 'ja' : 'th'

  // ãƒ†ãƒ¼ãƒã‚«ãƒ©ãƒ¼è¨­å®š
  const accentColor = isJapanese ? 'red' : 'amber'
  const btnActiveClass = isJapanese
    ? 'bg-red-500 hover:bg-red-600'
    : 'bg-amber-500 hover:bg-amber-600'

  /**
   * éŒ²éŸ³åˆ¶å¾¡ãƒãƒ³ãƒ‰ãƒ©
   * idle â†’ recording â†’ APIé€ä¿¡ â†’ result
   */
  async function handleRecord() {
    if (state === 'idle') {
      // éŒ²éŸ³é–‹å§‹
      await start()
    } else if (state === 'recording') {
      // éŒ²éŸ³åœæ­¢
      const blob = await stop()
      if (!blob) {
        onError('No audio captured. Please try again.')
        return
      }

      try {
        // APIã¸é€ä¿¡
        const result = await assessPronunciation(
          blob,
          entry.word,
          entry.romanization,
          lang,
        )
        onResult(result)
      } catch (e) {
        const msg = e instanceof Error ? e.message : 'Assessment failed'
        onError(msg)
      }
    }
  }

  const isRecording = state === 'recording'
  const isProcessing = state === 'processing'

  return (
    <div className="space-y-4">
      {/* éŒ²éŸ³ãƒœã‚¿ãƒ³ */}
      <div className="flex justify-center">
        <button
          onClick={handleRecord}
          disabled={isProcessing}
          className={`relative flex items-center justify-center w-24 h-24 rounded-full 
            font-bold text-white transition-all duration-300 shadow-2xl
            ${isProcessing
              ? 'bg-gray-700 cursor-not-allowed'
              : isRecording
                ? `${btnActiveClass} ring-4 recording-pulse`
                : `${btnActiveClass} hover:scale-105`
            }`}
        >
          {isProcessing ? (
            <Loader2 size={36} className="animate-spin" />
          ) : isRecording ? (
            <MicOff size={36} />
          ) : (
            <Mic size={36} />
          )}

          {/* éŒ²éŸ³ä¸­è¡¨ç¤º */}
          {isRecording && (
            <span className="absolute top-2 right-2 w-3 h-3 rounded-full bg-white animate-ping" />
          )}
        </button>
      </div>

      {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ†ã‚­ã‚¹ãƒˆ */}
      <div className="text-center text-sm">
        {isRecording && (
          <span className={`text-${accentColor}-400 font-semibold animate-pulse`}>
            â— éŒ²éŸ³ä¸­...
          </span>
        )}
        {isProcessing && (
          <span className="text-blue-400 font-semibold">
            â³ éŸ³å£°ã‚’åˆ†æä¸­...
          </span>
        )}
      </div>
    </div>
  )
}
```

### 4.2 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ©Ÿèƒ½ä¸€è¦§

#### 4.2.1 ãƒ¬ãƒ¼ãƒ™ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³è·é›¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

```typescript
// backend/src/routes/pronunciation.ts

/**
 * ãƒ¬ãƒ¼ãƒ™ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³è·é›¢ï¼ˆç·¨é›†è·é›¢ï¼‰è¨ˆç®—
 * 2ã¤ã®æ–‡å­—åˆ—é–“ã®æœ€å°ç·¨é›†æ“ä½œæ•°ã‚’è¿”ã™
 * æ“ä½œ: æŒ¿å…¥ã€å‰Šé™¤ã€ç½®æ›
 * 
 * æ™‚é–“è¨ˆç®—é‡: O(m Ã— n)
 * ç©ºé–“è¨ˆç®—é‡: O(m Ã— n) â†’ æœ€é©åŒ–å¾Œ O(min(m, n))
 */
function levenshtein(a: string, b: string): number {
  const m = a.length
  const n = b.length
  
  // 1æ¬¡å…ƒé…åˆ—ã‚’ä½¿ç”¨ã—ãŸç©ºé–“æœ€é©åŒ–
  const dp: number[] = Array.from({ length: (m + 1) * (n + 1) }, () => 0)
  const idx = (i: number, j: number) => i * (n + 1) + j

  // åŸºåº•ã‚±ãƒ¼ã‚¹: ç‰‡æ–¹ãŒç©ºæ–‡å­—åˆ—ã®å ´åˆ
  for (let i = 0; i <= m; i++) dp[idx(i, 0)] = i
  for (let j = 0; j <= n; j++) dp[idx(0, j)] = j

  // å‹•çš„è¨ˆç”»æ³•ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åŸ‹ã‚ã‚‹
  for (let i = 1; i <= m; i++) {
    for (let j = 1; j <= n; j++) {
      if (a[i - 1] === b[j - 1]) {
        // æ–‡å­—ãŒä¸€è‡´ â†’ ã‚³ã‚¹ãƒˆãªã—
        dp[idx(i, j)] = dp[idx(i - 1, j - 1)]!
      } else {
        // æœ€å°ã‚³ã‚¹ãƒˆã‚’é¸æŠ
        // 1. å‰Šé™¤ (dp[i-1][j])
        // 2. æŒ¿å…¥ (dp[i][j-1])
        // 3. ç½®æ› (dp[i-1][j-1])
        dp[idx(i, j)] = 1 + Math.min(
          dp[idx(i - 1, j)]!,      // å‰Šé™¤
          dp[idx(i, j - 1)]!,      // æŒ¿å…¥
          dp[idx(i - 1, j - 1)]!,  // ç½®æ›
        )
      }
    }
  }
  
  return dp[idx(m, n)]!
}
```

#### 4.2.2 ç²¾åº¦è¨ˆç®—é–¢æ•°

```typescript
/**
 * ç²¾åº¦ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆ0-100ï¼‰
 * ãƒ¬ãƒ¼ãƒ™ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³è·é›¢ã‹ã‚‰ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã‚’ç®—å‡º
 */
function calcAccuracy(expected: string, transcribed: string): number {
  // å‰å‡¦ç†: å°æ–‡å­—åŒ–ã€ç©ºç™½é™¤å»
  const a = expected.toLowerCase().replace(/\s+/g, '')
  const b = transcribed.toLowerCase().replace(/\s+/g, '')
  
  if (!a.length) return 0
  
  const dist = levenshtein(a, b)
  
  // ç²¾åº¦ = (å…ƒã®é•·ã• - ç·¨é›†è·é›¢) / å…ƒã®é•·ã• Ã— 100
  return Math.max(0, Math.round(((a.length - dist) / a.length) * 100))
}
```

#### 4.2.3 GPT-4oç™ºéŸ³åˆ†æ

```typescript
/**
 * GPT-4oã«ã‚ˆã‚‹è©³ç´°ç™ºéŸ³åˆ†æ
 * éŸ³å£°çš„é¡ä¼¼æ€§ã«åŸºã¥ãã‚¹ã‚³ã‚¢ã¨æ”¹å–„ææ¡ˆã‚’ç”Ÿæˆ
 */
async function analyzeWithGPT(
  openai: OpenAI,
  expectedWord: string,
  expectedRoman: string,
  spokenText: string,
  wordTimings: WordTiming[],
  lang: 'ja' | 'th',
): Promise<AIAnalysis> {
  // lang = 'ja' â†’ ã‚¿ã‚¤äººãŒæ—¥æœ¬èªå­¦ç¿’ â†’ æŒ‡å°ã¯ã‚¿ã‚¤èª
  // lang = 'th' â†’ æ—¥æœ¬äººãŒã‚¿ã‚¤èªå­¦ç¿’ â†’ æŒ‡å°ã¯æ—¥æœ¬èª
  const targetLang   = lang === 'ja' ? 'Japanese' : 'Thai'
  const feedbackLang = lang === 'ja' ? 'Thai'     : 'Japanese'

  const response = await openai.chat.completions.create({
    model: 'gpt-4o',
    messages: [
      {
        role: 'system',
        content: `You are a strict ${targetLang} pronunciation coach.
The learner's native language is ${feedbackLang}.

Scoring criteria:
- 90-100: Near-perfect pronunciation
- 70-89:  Minor issues (tone, length, aspiration)
- 50-69:  Noticeable errors but intelligible
- 30-49:  Significant errors, hard to understand
- 0-29:   Very wrong or completely different word

Return JSON:
{
  "score": <integer 0-100>,
  "feedback": "<coaching tip in ${feedbackLang}>",
  "mispronounced": ["<syllable>", ...]
}`,
      },
      {
        role: 'user',
        content: `Target: "${expectedWord}" (${expectedRoman})
Spoken: "${spokenText}"
Timings: ${JSON.stringify(wordTimings)}`,
      },
    ],
    response_format: { type: 'json_object' },
  })

  const raw = response.choices[0]?.message?.content ?? '{}'
  const parsed = JSON.parse(raw) as Partial<AIAnalysis>
  
  return {
    score: typeof parsed.score === 'number' 
      ? Math.max(0, Math.min(100, parsed.score)) 
      : 0,
    feedback: typeof parsed.feedback === 'string' ? parsed.feedback : '',
    mispronounced: Array.isArray(parsed.mispronounced) ? parsed.mispronounced : [],
  }
}
```

---

## 5. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 5.1 ç™ºéŸ³è©•ä¾¡ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç™ºéŸ³è©•ä¾¡ã‚·ãƒ¼ã‚±ãƒ³ã‚¹                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ãƒ¦ãƒ¼ã‚¶ãƒ¼              ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰           ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰           OpenAI
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚ 1. éŒ²éŸ³ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯  â”‚                       â”‚                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚ 2. MediaRecorderé–‹å§‹   â”‚                    â”‚
    â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚ 3. è©±ã™                â”‚                       â”‚                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚ 4. åœæ­¢ãƒœã‚¿ãƒ³          â”‚                       â”‚                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚ 5. Blobç”Ÿæˆ            â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚ 6. FormDataä½œæˆ        â”‚                    â”‚
    â”‚                       â”‚   - audio: Blob       â”‚                    â”‚
    â”‚                       â”‚   - expectedWord      â”‚                    â”‚
    â”‚                       â”‚   - lang              â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚ 7. POST /api/assess   â”‚                    â”‚
    â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚ 8. Whisper-1       â”‚
    â”‚                       â”‚                       â”‚    éŸ³å£°èªè­˜         â”‚
    â”‚                       â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚ 9. èªè­˜çµæœ        â”‚
    â”‚                       â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚ 10. ãƒ¬ãƒ¼ãƒ™ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³
    â”‚                       â”‚                       â”‚     è·é›¢è¨ˆç®—       â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚ 11. GPT-4oåˆ†æ     â”‚
    â”‚                       â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚ 12. åˆ†æçµæœ       â”‚
    â”‚                       â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚ 13. AssessResponse    â”‚                    â”‚
    â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
    â”‚                       â”‚   - accuracy          â”‚                    â”‚
    â”‚                       â”‚   - aiScore           â”‚                    â”‚
    â”‚                       â”‚   - aiFeedback        â”‚                    â”‚
    â”‚                       â”‚   - charDiff          â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚ 14. çµæœè¡¨ç¤º           â”‚                       â”‚                    â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
```

### 5.2 å˜èªæ¤œç´¢ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å˜èªæ¤œç´¢ã‚·ãƒ¼ã‚±ãƒ³ã‚¹                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ãƒ¦ãƒ¼ã‚¶ãƒ¼              ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰           ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰           GPT-4o
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚ 1. å˜èªå…¥åŠ›            â”‚                       â”‚                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚ 2. POST /api/lookup   â”‚                    â”‚
    â”‚                       â”‚   { word, lang }      â”‚                    â”‚
    â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚ 3. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ   â”‚
    â”‚                       â”‚                       â”‚   - éŸ³ç¯€åˆ†è§£       â”‚
    â”‚                       â”‚                       â”‚   - ã‚¢ã‚¯ã‚»ãƒ³ãƒˆæƒ…å ± â”‚
    â”‚                       â”‚                       â”‚   - ç¿»è¨³           â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚ 4. GPT-4oå‘¼ã³å‡ºã— â”‚
    â”‚                       â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚ 5. JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ â”‚
    â”‚                       â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                       â”‚                       â”‚   { word,          â”‚
    â”‚                       â”‚                       â”‚     syllables[],   â”‚
    â”‚                       â”‚                       â”‚     meaning... }   â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚                       â”‚ 6. VocabEntryå½¢å¼ã§è¿”å´â”‚                    â”‚
    â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
    â”‚ 7. WordCardè¡¨ç¤º        â”‚                       â”‚                    â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                    â”‚
    â”‚                       â”‚                       â”‚                    â”‚
```

---

## 6. ã‚³ã‚¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### 6.1 æ–‡å­—ãƒ¬ãƒ™ãƒ«å·®åˆ†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

```typescript
/**
 * æ–‡å­—ãƒ¬ãƒ™ãƒ«å·®åˆ†è¨ˆç®—
 * æœŸå¾…æ–‡å­—åˆ—ã¨èªè­˜çµæœã‚’æ¯”è¼ƒã—ã€è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”¨ã®å·®åˆ†ã‚’ç”Ÿæˆ
 * 
 * ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : å˜ç´”ãªä½ç½®ãƒ™ãƒ¼ã‚¹æ¯”è¼ƒ
 * ç”¨é€”: UIã§ã®æ–‡å­—ã”ã¨ã®æ­£èª¤è¡¨ç¤º
 */
type DiffStatus = 'correct' | 'wrong' | 'missing' | 'extra'

interface CharDiff {
  char: string
  status: DiffStatus
}

function charDiff(expected: string, transcribed: string): CharDiff[] {
  const exp = expected.toLowerCase().replace(/\s+/g, '')
  const got = transcribed.toLowerCase().replace(/\s+/g, '')
  const result: CharDiff[] = []

  const maxLen = Math.max(exp.length, got.length)
  
  for (let i = 0; i < maxLen; i++) {
    const ec = exp[i]
    const gc = got[i]
    
    if (ec && gc) {
      // ä¸¡æ–¹ã«æ–‡å­—ã‚ã‚Š â†’ æ¯”è¼ƒ
      result.push({ 
        char: gc, 
        status: ec === gc ? 'correct' : 'wrong' 
      })
    } else if (ec && !gc) {
      // æœŸå¾…ã®ã¿ â†’ æ¬ è½
      result.push({ char: ec, status: 'missing' })
    } else if (!ec && gc) {
      // èªè­˜ã®ã¿ â†’ ä½™åˆ†
      result.push({ char: gc, status: 'extra' })
    }
  }
  
  return result
}

// ä½¿ç”¨ä¾‹:
// charDiff("ã“ã‚“ã«ã¡ã¯", "ã“ã‚“ã«ã¡ã‚") â†’ 
// [
//   { char: "ã“", status: "correct" },
//   { char: "ã‚“", status: "correct" },
//   { char: "ã«", status: "correct" },
//   { char: "ã¡", status: "correct" },
//   { char: "ã‚", status: "wrong" }   // ã€Œã¯ã€ãŒã€Œã‚ã€ã«èª¤èªè­˜
// ]
```

### 6.2 ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯

```typescript
/**
 * ã‚¹ã‚³ã‚¢ã«åŸºã¥ããƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ
 * ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚·ãƒ³ãƒ—ãƒ«ãªåˆ¤å®š
 */
function buildFeedback(accuracy: number): { th: string; ja: string } {
  if (accuracy >= 90) {
    return {
      th: 'ğŸ‰ à¸¢à¸­à¸”à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸¡à¸²à¸! à¸à¸²à¸£à¸­à¸­à¸à¹€à¸ªà¸µà¸¢à¸‡à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¸¡à¸²à¸!',
      ja: 'ğŸ‰ ç´ æ™´ã‚‰ã—ã„ï¼ç™ºéŸ³ãŒã¨ã¦ã‚‚æ­£ç¢ºã§ã™ï¼',
    }
  } else if (accuracy >= 70) {
    return {
      th: 'ğŸ‘ à¸”à¸µà¸¡à¸²à¸! à¸¥à¸­à¸‡à¸à¸¶à¸à¸­à¸µà¸à¸™à¸´à¸”à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¸Šà¸±à¸”à¸‚à¸¶à¹‰à¸™',
      ja: 'ğŸ‘ ã‚ˆãã§ãã¾ã—ãŸï¼ã‚‚ã†å°‘ã—ç·´ç¿’ã™ã‚‹ã¨ã•ã‚‰ã«ä¸Šæ‰‹ã«ãªã‚Šã¾ã™',
    }
  } else if (accuracy >= 50) {
    return {
      th: 'ğŸ’ª à¸à¸¢à¸²à¸¢à¸²à¸¡à¸”à¸µà¸™à¸°! à¸¥à¸­à¸‡à¸Ÿà¸±à¸‡à¹€à¸ªà¸µà¸¢à¸‡à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸­à¸µà¸à¸£à¸­à¸š',
      ja: 'ğŸ’ª é ‘å¼µã£ã¦ã„ã¾ã™ï¼ã‚‚ã†ä¸€åº¦ãŠæ‰‹æœ¬ã®éŸ³å£°ã‚’èã„ã¦ç·´ç¿’ã—ã¦ã¿ã¾ã—ã‚‡ã†',
    }
  } else {
    return {
      th: 'ğŸ”„ à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆà¸™à¸°! à¸à¸”à¸›à¸¸à¹ˆà¸¡ ğŸ”Š à¹€à¸à¸·à¹ˆà¸­à¸Ÿà¸±à¸‡à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¹ˆà¸­à¸™',
      ja: 'ğŸ”„ ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼ğŸ”Šãƒœã‚¿ãƒ³ã§ãŠæ‰‹æœ¬ã‚’èã„ã¦ã‹ã‚‰ç·´ç¿’ã—ã¦ãã ã•ã„',
    }
  }
}
```

---

## 7. APIä»•æ§˜è©³ç´°

### 7.1 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

| ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ | èªè¨¼ |
|---------|---------------|------|------|
| GET | `/api/health` | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ | ä¸è¦ |
| POST | `/api/assess` | ç™ºéŸ³è©•ä¾¡ | API Key |
| POST | `/api/transcribe` | æ–‡å­—èµ·ã“ã— | API Key |
| POST | `/api/lookup` | å˜èªæ¤œç´¢ | API Key |
| POST | `/api/tokenize` | æ–‡åˆ†è§£ | API Key |

### 7.2 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹è©³ç´°

#### POST /api/assess

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```http
POST /api/assess HTTP/1.1
Content-Type: multipart/form-data

------WebKitFormBoundary
Content-Disposition: form-data; name="audio"; filename="recording.webm"
Content-Type: audio/webm

<binary data>
------WebKitFormBoundary
Content-Disposition: form-data; name="expectedWord"

ã“ã‚“ã«ã¡ã¯
------WebKitFormBoundary
Content-Disposition: form-data; name="expectedRoman"

konnichiwa
------WebKitFormBoundary
Content-Disposition: form-data; name="lang"

ja
------WebKitFormBoundary--
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "ok": true,
  "transcribed": "ã“ã‚“ã«ã¡ã¯",
  "wordTimings": [
    {
      "word": "ã“ã‚“ã«ã¡ã¯",
      "start": 0.0,
      "end": 1.24
    }
  ],
  "accuracy": 100,
  "charDiff": [
    { "char": "ã“", "status": "correct" },
    { "char": "ã‚“", "status": "correct" },
    { "char": "ã«", "status": "correct" },
    { "char": "ã¡", "status": "correct" },
    { "char": "ã¯", "status": "correct" }
  ],
  "feedback": {
    "th": "ğŸ‰ à¸¢à¸­à¸”à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸¡à¸²à¸!",
    "ja": "ğŸ‰ ç´ æ™´ã‚‰ã—ã„ï¼"
  },
  "aiScore": 95,
  "aiFeedback": "ãƒã‚¤ãƒ†ã‚£ãƒ–ã«è¿‘ã„ç™ºéŸ³ã§ã™ã€‚ã¯è¡Œã®ç™ºéŸ³ãŒç‰¹ã«è‰¯ã„ã§ã™ã€‚",
  "mispronounced": []
}
```

### 7.3 ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```json
{
  "ok": false,
  "transcribed": "",
  "wordTimings": [],
  "accuracy": 0,
  "charDiff": [],
  "feedback": {
    "th": "à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”: API Error",
    "ja": "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: API Error"
  },
  "aiScore": 0,
  "aiFeedback": "",
  "mispronounced": [],
  "error": "API Error"
}
```

---

## 8. å®Ÿè£…ä¸Šã®æ³¨æ„äº‹é …

### 8.1 MIMEã‚¿ã‚¤ãƒ—å‡¦ç†

Chromeã®MediaRecorderã¯éŸ³å£°ã®ã¿ã®éŒ²éŸ³ã§ã‚‚`video/webm`ã‚’è¿”ã™ã€‚ã“ã‚Œã¯Whisperã§å•é¡Œãªãå‡¦ç†ã•ã‚Œã‚‹ãŒã€ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ã¯é©åˆ‡ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼š

```typescript
// services/api.ts
let ext = 'webm'
if (audio.type.includes('ogg')) ext = 'ogg'
else if (audio.type.includes('mp4') || audio.type.includes('m4a')) ext = 'mp4'
else if (audio.type.includes('wav')) ext = 'wav'

form.append('audio', audio, `recording.${ext}`)
```

### 8.2 ç’°å¢ƒå¤‰æ•°ç®¡ç†

```bash
# é–‹ç™ºç’°å¢ƒ
.env
â”œâ”€â”€ OPENAI_API_KEY=sk-...
â””â”€â”€ PORT=3001

# æœ¬ç•ªç’°å¢ƒã§ã¯ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦è¨­å®š
export OPENAI_API_KEY=sk-...
export PORT=3001
```

### 8.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

1. **API Keyä¿è­·**: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã®ã¿ä½¿ç”¨ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«éœ²å‡ºã—ãªã„
2. **CORSè¨­å®š**: è¨±å¯æ¸ˆã¿ã‚ªãƒªã‚¸ãƒ³ã®ã¿
3. **å…¥åŠ›æ¤œè¨¼**: Elysiaã®å‹ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹è‡ªå‹•æ¤œè¨¼
4. **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: æœ¬ç•ªç’°å¢ƒã§ã¯æ¤œè¨ãŒå¿…è¦

### 8.4 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

| é …ç›® | å¯¾ç­– |
|------|------|
| éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º | WebM Opusã‚³ãƒ¼ãƒ‡ãƒƒã‚¯ä½¿ç”¨ |
| APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ  | Whisperä¸¦åˆ—å‡¦ç†æ¤œè¨ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | React.memoé©ç”¨æ¤œè¨ |
| ãƒ“ãƒ«ãƒ‰ | Viteã«ã‚ˆã‚‹æœ€é©åŒ– |

---

## ä»˜éŒ²

### A. å‹å®šç¾©ä¸€è¦§

```typescript
// types/index.ts - ä¸»è¦å‹å®šç¾©

export interface VocabEntry {
  id: string
  category: string
  word: string
  reading: string
  romanization: string
  syllables: PitchSyllable[] | ThaiSyllable[]
  meaningTh: string
  meaningJa: string
  exampleSentence: string
  exampleTranslation: string
  ttsLang: 'ja-JP' | 'th-TH'
}

export interface AssessResponse {
  ok: boolean
  transcribed: string
  wordTimings: WordTiming[]
  accuracy: number
  charDiff: CharDiffToken[]
  feedback: { th: string; ja: string }
  aiScore: number
  aiFeedback: string
  mispronounced: string[]
  error?: string
}
```

### B. é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- è‹±èªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: `DOCUMENTATION.md`
- æ—¥æœ¬èªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: `DOCUMENTATION_JA.md`
- å­¦è¡“çš„èƒŒæ™¯: `ACADEMIC.md`

---

**ä½œæˆè€…:** æŠ€è¡“ãƒãƒ¼ãƒ   
**ãƒ¬ãƒ“ãƒ¥ãƒ¼:** å¾…ã¡  
**æ‰¿èª:** å¾…ã¡

---

*æœ¬æ›¸ã®å†…å®¹ã¯å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚æœ€æ–°æƒ…å ±ã¯ãƒªãƒã‚¸ãƒˆãƒªã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚*
